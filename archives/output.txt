--- Starting Pipeline with Model: catboost ---

=== STAGE 1: TRAINING ===
--- Starting Pipeline with Model: catboost ---
--- Preparing Training Dataset ---
Found cached dataset: D:\workspace\Tidal Disruption Classification\datasets\combined_curves/train_all_full_lightcurves.csv
Loading directly (skipping split folders)...
Extracting Features for train...
Fitting 2D GPs on 3043 objects using ALL cores...
Merging Redshift & Calculating Luminosity...
Saving features to cache: datasets/processed_data/processed_training_data.csv...
Completed in 0:00:30
Merging Target Labels...

--- Initializing Hybrid Ensemble Classifier ---
   Fold 1: F1=0.7324 (Thresh=0.28) - Validation Positives: 29
   Fold 2: F1=0.6757 (Thresh=0.38) - Validation Positives: 30
   Fold 3: F1=0.7213 (Thresh=0.40) - Validation Positives: 30
   Fold 4: F1=0.7368 (Thresh=0.42) - Validation Positives: 30
   Fold 5: F1=0.7246 (Thresh=0.24) - Validation Positives: 29

   Average Ensemble F1: 0.7182

--- Training Final Production Model ---

--- Feature Importance (Top 10) ---
template_chisq_tde: 8.5893
negative_flux_fraction: 5.6328
log_tde_error: 5.1587
tde_power_law_error: 4.7952
duty_cycle: 4.5810
robust_duration: 4.2497
percentile_ratio_80_max: 4.1387
ls_wave: 3.8016
std_color_gr: 2.8843
total_radiated_energy: 2.7869

Production model saved to D:\workspace\Tidal Disruption Classification\models\tde_classifier.pkl
Optimized threshold (0.34) saved to D:\workspace\Tidal Disruption Classification\models\threshold.txt

=== STAGE 2: PREDICTION ===
Loading Test Lightcurves...
--- Preparing Testing Dataset ---
Found cached dataset: D:\workspace\Tidal Disruption Classification\datasets\combined_curves/test_all_full_lightcurves.csv
Loading directly (skipping split folders)...
Extracting Features for test...
Fitting 2D GPs on 7135 objects using ALL cores...
Merging Redshift & Calculating Luminosity...
Saving features to cache: datasets/processed_data/processed_testing_data.csv...
Completed in 0:01:23
Loading model from D:\workspace\Tidal Disruption Classification\models\tde_classifier.pkl...
Loaded optimized decision threshold: 0.344
Generating predictions...
Finalizing submission file...
Submission saved to D:\workspace\Tidal Disruption Classification\results\submission_2026-01-31_0.7182.csv
Total TDEs predicted in Test Set: 449