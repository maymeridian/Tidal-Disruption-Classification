PS D:\workspace\Tidal Disruption Classification> python main.py --train --predict
--- Starting Pipeline with Model: catboost ---

=== STAGE 1: TRAINING ===
--- Starting Pipeline with Model: catboost ---
--- Preparing Training Dataset ---
Found cached dataset: D:\workspace\Tidal Disruption Classification\datasets\combined_curves/train_all_full_lightcurves.csv
Loading directly (skipping split folders)...
Loading cached features from datasets/processed_data/processed_training_data.csv...
Merging Target Labels...

--- Initializing Hybrid Ensemble Classifier ---
    Configuration: Gradient Boosting (Core) + MLP/KNN (Support)
   Fold 1: F1=0.7119 (Thresh=0.50) - Validation Positives: 29
   Fold 2: F1=0.7042 (Thresh=0.44) - Validation Positives: 30
   Fold 3: F1=0.7419 (Thresh=0.40) - Validation Positives: 30
   Fold 4: F1=0.7368 (Thresh=0.40) - Validation Positives: 30
   Fold 5: F1=0.7302 (Thresh=0.26) - Validation Positives: 29

   Average Ensemble F1: 0.7250

--- Training Final Production Model ---

--- Feature Importance (Top 10) ---
template_chisq_tde: 8.4505
negative_flux_fraction: 5.6603
duty_cycle: 5.1122
tde_power_law_error: 4.8737
log_tde_error: 4.4370
robust_duration: 4.3718
percentile_ratio_80_max: 4.2500
ls_wave: 3.5456
total_radiated_energy: 2.9022
compactness: 2.6102

Production model saved to D:\workspace\Tidal Disruption Classification\models\tde_classifier.pkl
Optimized threshold (0.40) saved to D:\workspace\Tidal Disruption Classification\models\threshold.txt

=== STAGE 2: PREDICTION ===
Loading Test Lightcurves...
--- Preparing Testing Dataset ---
Found cached dataset: D:\workspace\Tidal Disruption Classification\datasets\combined_curves/test_all_full_lightcurves.csv
Loading directly (skipping split folders)...
Loading cached features from datasets/processed_data/processed_testing_data.csv...
Loading model from D:\workspace\Tidal Disruption Classification\models\tde_classifier.pkl...
Loaded optimized decision threshold: 0.3999999999999999
Generating predictions...
Finalizing submission file...
Submission saved to D:\workspace\Tidal Disruption Classification\results\submission_2026-01-30_0.7250.csv
Total TDEs predicted in Test Set: 403
PS D:\workspace\Tidal Disruption Classification> 